{"ast":null,"code":"var _jsxFileName = \"/home/amar/Projects/amazona/frontend/src/screens/OrderScreen.js\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { detailsOrder } from '../actions/orderActions';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nexport default function OrderScreen(props) {\n  _s();\n\n  const orderId = props.match.params.id;\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    order,\n    loading,\n    error\n  } = orderDetails;\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(detailsOrder(orderId));\n  }, [dispatch, orderId]);\n\n  const paymentHandler = async e => {\n    const API_URL = 'http://localhost:5000/';\n    e.preventDefault();\n    const orderUrl = `${API_URL}api/orders/order`;\n    const orderObj = {\n      // \"token\": localStorage.userInfo.token,\n      // \"userId\": localStorage.userInfo._id,\n      \"amount\": order.totalPrice\n    };\n    console.log(orderObj.token);\n    console.log(orderObj.userId);\n    console.log(orderObj.amount);\n    axios.post(orderUrl, orderObj).then(res => {\n      if (res.status = 200) {\n        const {\n          data\n        } = res;\n        const options = {\n          key: \"rzp_test_s7qD5G9sGciEWZ\",\n          name: \"Evidhyalaya\",\n          description: \"To Explore and share the knowledge \",\n          order_id: data.id,\n          handler: async response => {\n            try {\n              const paymentId = response.razorpay_payment_id;\n              const url = `${API_URL}api/orders/capture/${paymentId}`;\n              const captureResponse = await axios.post(url, {\n                \"token\": localStorage.userInfo.token,\n                \"userId\": localStorage.userInfo._id,\n                \"amount\": order.totalPrice\n              });\n              console.log(captureResponse.data);\n\n              if (captureResponse) {\n                this.props.history.push('/success');\n              }\n            } catch (err) {\n              console.log(err);\n            }\n          },\n          theme: {\n            color: \"#686CFD\"\n          }\n        };\n        const rzp1 = new window.Razorpay(options);\n        rzp1.open();\n      } else {\n        props.history.push('/fail');\n      }\n    }).catch(err => {//this.setState({ 'notLoggedIn': 1 });\n    });\n  };\n\n  return loading ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }) : error ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 5\n    }\n  }, error) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 11\n    }\n  }, \"Order \", order._id), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 21\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 23\n    }\n  }, \"Name:\"), \" \", order.shippingAddress.fullName, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 79\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 23\n    }\n  }, \"Address: \"), \" \", order.shippingAddress.address, \",\", order.shippingAddress.city, \",\", ' ', order.shippingAddress.postalCode, \",\", order.shippingAddress.country))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 21\n    }\n  }, \"Payment\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 23\n    }\n  }, \"Method:\"), \" \", order.paymentMethod))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }, \"Order Items\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }, order.orderItems.map(item => /*#__PURE__*/React.createElement(\"li\", {\n    key: item.product,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: item.image,\n    alt: item.name,\n    className: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 31\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"min-30\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/product/${item.product}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 31\n    }\n  }, item.name)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 29\n    }\n  }, item.qty, \" x $\", item.price, \" = $\", item.qty * item.price))))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 21\n    }\n  }, \"Order Summary\")), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 23\n    }\n  }, \"Items\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 23\n    }\n  }, \"$\", order.itemsPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 23\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 23\n    }\n  }, \"$\", order.shippingPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 23\n    }\n  }, \"Tax\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 23\n    }\n  }, \"$\", order.taxPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 25\n    }\n  }, \" Order Total\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 25\n    }\n  }, \"$\", order.totalPrice.toFixed(2))))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: paymentHandler,\n    className: \"primary block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 21\n    }\n  }, \"Pay Now\")))))));\n}\n\n_s(OrderScreen, \"riauKPy2+6a5ebMJWvOUMcKw7sk=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = OrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderScreen\");","map":{"version":3,"sources":["/home/amar/Projects/amazona/frontend/src/screens/OrderScreen.js"],"names":["axios","React","useEffect","useDispatch","useSelector","Link","detailsOrder","LoadingBox","MessageBox","OrderScreen","props","orderId","match","params","id","orderDetails","state","order","loading","error","dispatch","paymentHandler","e","API_URL","preventDefault","orderUrl","orderObj","totalPrice","console","log","token","userId","amount","post","then","res","status","data","options","key","name","description","order_id","handler","response","paymentId","razorpay_payment_id","url","captureResponse","localStorage","userInfo","_id","history","push","err","theme","color","rzp1","window","Razorpay","open","catch","shippingAddress","fullName","address","city","postalCode","country","paymentMethod","orderItems","map","item","product","image","qty","price","itemsPrice","toFixed","shippingPrice","taxPrice"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { detailsOrder } from '../actions/orderActions';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\n\nexport default function OrderScreen(props) {\n  const orderId = props.match.params.id;\n  const orderDetails = useSelector((state) => state.orderDetails);\n  const { order, loading, error } = orderDetails;\n\n  \n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(detailsOrder(orderId));\n  }, [dispatch, orderId]);\n\n  const paymentHandler = async (e) => {\n    const API_URL = 'http://localhost:5000/'\n    e.preventDefault();\n    const orderUrl = `${API_URL}api/orders/order`;\n    const orderObj = {\n      // \"token\": localStorage.userInfo.token,\n      // \"userId\": localStorage.userInfo._id,\n      \"amount\": order.totalPrice,\n    }\n    console.log(orderObj.token)\n    console.log(orderObj.userId)\n    console.log(orderObj.amount)\n\n    axios.post(orderUrl, orderObj).then(res => {\n      if (res.status = 200) {\n        const { data } = res;\n        const options = {\n          key: \"rzp_test_s7qD5G9sGciEWZ\",\n          name: \"Evidhyalaya\",\n          description: \"To Explore and share the knowledge \",\n          order_id: data.id,\n          handler: async (response) => {\n            try {\n              const paymentId = response.razorpay_payment_id;\n              const url = `${API_URL}api/orders/capture/${paymentId}`;\n              const captureResponse = await axios.post(url, { \"token\": localStorage.userInfo.token, \"userId\": localStorage.userInfo._id, \"amount\": order.totalPrice })\n              console.log(captureResponse.data);\n              if (captureResponse) {\n                this.props.history.push('/success');\n              }\n            } catch (err) {\n              console.log(err);\n            }\n          },\n          theme: {\n            color: \"#686CFD\",\n          },\n        };\n        const rzp1 = new window.Razorpay(options);\n        rzp1.open();\n      }\n      else{\n        props.history.push('/fail')\n      }\n    }).catch(err => {\n      //this.setState({ 'notLoggedIn': 1 });\n    })\n  }\n\n  return loading ? (\n    <LoadingBox></LoadingBox>\n  ) : error ? (\n    <MessageBox variant=\"danger\">{error}</MessageBox>\n  ) : (\n        <div>\n          <h1>Order {order._id}</h1>\n          <div className=\"row top\">\n            <div className=\"col-2\">\n              <ul>\n                <li>\n                  <div className=\"card card-body\">\n                    <h2>Shipping</h2>\n                    <p>\n                      <strong>Name:</strong> {order.shippingAddress.fullName} <br />\n                      <strong>Address: </strong> {order.shippingAddress.address},\n                  {order.shippingAddress.city},{' '}\n                      {order.shippingAddress.postalCode},\n                  {order.shippingAddress.country}\n                    </p>\n                    {/* {order.isDelivered ? (\n                      <MessageBox variant=\"success\">\n                        Delivered at {order.deliveredAt}\n                      </MessageBox>\n                    ) : (\n                        <MessageBox variant=\"danger\">Not Delivered</MessageBox>\n                      )} */}\n                  </div>\n                </li>\n                <li>\n                  <div className=\"card card-body\">\n                    <h2>Payment</h2>\n                    <p>\n                      <strong>Method:</strong> {order.paymentMethod}\n                    </p>\n                    {/* {order.isPaid ? (\n                      <MessageBox variant=\"success\">\n                        Paid at {order.paidAt}\n                      </MessageBox>\n                    ) : (\n                        <MessageBox variant=\"danger\">Not Paid</MessageBox>\n                      )} */}\n                  </div>\n                </li>\n                <li>\n                  <div className=\"card card-body\">\n                    <h2>Order Items</h2>\n                    <ul>\n                      {order.orderItems.map((item) => (\n                        <li key={item.product}>\n                          <div className=\"row\">\n                            <div>\n                              <img\n                                src={item.image}\n                                alt={item.name}\n                                className=\"small\"\n                              ></img>\n                            </div>\n                            <div className=\"min-30\">\n                              <Link to={`/product/${item.product}`}>\n                                {item.name}\n                              </Link>\n                            </div>\n\n                            <div>\n                              {item.qty} x ${item.price} = ${item.qty * item.price}\n                            </div>\n                          </div>\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                </li>\n              </ul>\n            </div>\n            <div className=\"col-1\">\n              <div className=\"card card-body\">\n                <ul>\n                  <li>\n                    <h2>Order Summary</h2>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>Items</div>\n                      <div>${order.itemsPrice.toFixed(2)}</div>\n                    </div>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>Shipping</div>\n                      <div>${order.shippingPrice.toFixed(2)}</div>\n                    </div>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>Tax</div>\n                      <div>${order.taxPrice.toFixed(2)}</div>\n                    </div>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>\n                        <strong> Order Total</strong>\n                      </div>\n                      <div>\n                        <strong>${order.totalPrice.toFixed(2)}</strong>\n                      </div>\n                    </div>\n                  </li>\n                  <li>\n                    <button\n                      type=\"button\" onClick={paymentHandler}\n\n                      className=\"primary block\"\n\n                    >\n                      Pay Now\n                </button>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n}"]},"metadata":{},"sourceType":"module"}