{"ast":null,"code":"var _jsxFileName = \"/home/amar/Projects/amazona/frontend/src/screens/OrderScreen.js\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { detailsOrder } from '../actions/orderActions';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nexport default function OrderScreen(props) {\n  _s();\n\n  const orderId = props.match.params.id;\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    order,\n    loading,\n    error\n  } = orderDetails;\n\n  const paymentHandler = async e => {\n    const API_URL = 'http://localhost:5000/';\n    e.preventDefault();\n    const orderUrl = `${API_URL}order/order`;\n    const orderObj = {\n      \"token\": localStorage.userInfo.token,\n      \"userId\": localStorage.userInfo._id,\n      \"amount\": order.totalPrice\n    };\n    axios.post(orderUrl, orderObj).then(res => {\n      if (res.status = 200) {\n        const {\n          data\n        } = res;\n        const options = {\n          key: \"rzp_test_s7qD5G9sGciEWZ\",\n          name: \"Evidhyalaya\",\n          description: \"To Explore and share the knowledge \",\n          order_id: data.id,\n          handler: async response => {\n            try {\n              const paymentId = response.razorpay_payment_id;\n              const url = `${API_URL}order/capture/${paymentId}`;\n              const captureResponse = await axios.post(url, {\n                \"token\": localStorage.userInfo.token,\n                \"userId\": localStorage.userInfo._id,\n                \"amount\": order.totalPrice\n              });\n              console.log(captureResponse.data);\n\n              if (captureResponse) {\n                this.props.history.push('/success');\n              }\n            } catch (err) {\n              console.log(err);\n            }\n          },\n          theme: {\n            color: \"#686CFD\"\n          }\n        };\n        const rzp1 = new window.Razorpay(options);\n        rzp1.open();\n      }\n    }).catch(err => {\n      this.setState({\n        'notLoggedIn': 1\n      });\n    });\n  };\n\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(detailsOrder(orderId));\n  }, [dispatch, orderId]);\n  return loading ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 5\n    }\n  }) : error ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, error) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, \"Order \", order._id), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 21\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 23\n    }\n  }, \"Name:\"), \" \", order.shippingAddress.fullName, \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 79\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 23\n    }\n  }, \"Address: \"), \" \", order.shippingAddress.address, \",\", order.shippingAddress.city, \",\", ' ', order.shippingAddress.postalCode, \",\", order.shippingAddress.country))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 21\n    }\n  }, \"Payment\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 23\n    }\n  }, \"Method:\"), \" \", order.paymentMethod))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }, \"Order Items\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 21\n    }\n  }, order.orderItems.map(item => /*#__PURE__*/React.createElement(\"li\", {\n    key: item.product,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: item.image,\n    alt: item.name,\n    className: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 31\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"min-30\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/product/${item.product}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 31\n    }\n  }, item.name)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 29\n    }\n  }, item.qty, \" x $\", item.price, \" = $\", item.qty * item.price))))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 21\n    }\n  }, \"Order Summary\")), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 23\n    }\n  }, \"Items\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 23\n    }\n  }, \"$\", order.itemsPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 23\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 23\n    }\n  }, \"$\", order.shippingPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 23\n    }\n  }, \"Tax\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 23\n    }\n  }, \"$\", order.taxPrice.toFixed(2)))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 25\n    }\n  }, \" Order Total\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 25\n    }\n  }, \"$\", order.totalPrice.toFixed(2))))), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: paymentHandler,\n    className: \"primary block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }, \"Pay Now\")))))));\n}\n\n_s(OrderScreen, \"riauKPy2+6a5ebMJWvOUMcKw7sk=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = OrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderScreen\");","map":{"version":3,"sources":["/home/amar/Projects/amazona/frontend/src/screens/OrderScreen.js"],"names":["axios","React","useEffect","useDispatch","useSelector","Link","detailsOrder","LoadingBox","MessageBox","OrderScreen","props","orderId","match","params","id","orderDetails","state","order","loading","error","paymentHandler","e","API_URL","preventDefault","orderUrl","orderObj","localStorage","userInfo","token","_id","totalPrice","post","then","res","status","data","options","key","name","description","order_id","handler","response","paymentId","razorpay_payment_id","url","captureResponse","console","log","history","push","err","theme","color","rzp1","window","Razorpay","open","catch","setState","dispatch","shippingAddress","fullName","address","city","postalCode","country","paymentMethod","orderItems","map","item","product","image","qty","price","itemsPrice","toFixed","shippingPrice","taxPrice"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { detailsOrder } from '../actions/orderActions';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\n\nexport default function OrderScreen(props) {\n  const orderId = props.match.params.id;\n  const orderDetails = useSelector((state) => state.orderDetails);\n  const { order, loading, error } = orderDetails;\n\n  const paymentHandler = async (e) => {\n    const API_URL = 'http://localhost:5000/'\n    e.preventDefault();\n    const orderUrl = `${API_URL}order/order`;\n    const orderObj = {\n      \"token\": localStorage.userInfo.token,\n      \"userId\": localStorage.userInfo._id,\n      \"amount\": order.totalPrice,\n    }\n    axios.post(orderUrl, orderObj).then(res => {\n      if (res.status = 200) {\n        const { data } = res;\n        const options = {\n          key: \"rzp_test_s7qD5G9sGciEWZ\",\n          name: \"Evidhyalaya\",\n          description: \"To Explore and share the knowledge \",\n          order_id: data.id,\n          handler: async (response) => {\n            try {\n              const paymentId = response.razorpay_payment_id;\n              const url = `${API_URL}order/capture/${paymentId}`;\n              const captureResponse = await axios.post(url, { \"token\": localStorage.userInfo.token, \"userId\": localStorage.userInfo._id, \"amount\": order.totalPrice })\n              console.log(captureResponse.data);\n              if (captureResponse) {\n                this.props.history.push('/success');\n              }\n            } catch (err) {\n              console.log(err);\n            }\n          },\n          theme: {\n            color: \"#686CFD\",\n          },\n        };\n        const rzp1 = new window.Razorpay(options);\n        rzp1.open();\n      }\n    }).catch(err => {\n      this.setState({ 'notLoggedIn': 1 });\n    })\n  }\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(detailsOrder(orderId));\n  }, [dispatch, orderId]);\n  return loading ? (\n    <LoadingBox></LoadingBox>\n  ) : error ? (\n    <MessageBox variant=\"danger\">{error}</MessageBox>\n  ) : (\n        <div>\n          <h1>Order {order._id}</h1>\n          <div className=\"row top\">\n            <div className=\"col-2\">\n              <ul>\n                <li>\n                  <div className=\"card card-body\">\n                    <h2>Shipping</h2>\n                    <p>\n                      <strong>Name:</strong> {order.shippingAddress.fullName} <br />\n                      <strong>Address: </strong> {order.shippingAddress.address},\n                  {order.shippingAddress.city},{' '}\n                      {order.shippingAddress.postalCode},\n                  {order.shippingAddress.country}\n                    </p>\n                    {/* {order.isDelivered ? (\n                      <MessageBox variant=\"success\">\n                        Delivered at {order.deliveredAt}\n                      </MessageBox>\n                    ) : (\n                        <MessageBox variant=\"danger\">Not Delivered</MessageBox>\n                      )} */}\n                  </div>\n                </li>\n                <li>\n                  <div className=\"card card-body\">\n                    <h2>Payment</h2>\n                    <p>\n                      <strong>Method:</strong> {order.paymentMethod}\n                    </p>\n                    {/* {order.isPaid ? (\n                      <MessageBox variant=\"success\">\n                        Paid at {order.paidAt}\n                      </MessageBox>\n                    ) : (\n                        <MessageBox variant=\"danger\">Not Paid</MessageBox>\n                      )} */}\n                  </div>\n                </li>\n                <li>\n                  <div className=\"card card-body\">\n                    <h2>Order Items</h2>\n                    <ul>\n                      {order.orderItems.map((item) => (\n                        <li key={item.product}>\n                          <div className=\"row\">\n                            <div>\n                              <img\n                                src={item.image}\n                                alt={item.name}\n                                className=\"small\"\n                              ></img>\n                            </div>\n                            <div className=\"min-30\">\n                              <Link to={`/product/${item.product}`}>\n                                {item.name}\n                              </Link>\n                            </div>\n\n                            <div>\n                              {item.qty} x ${item.price} = ${item.qty * item.price}\n                            </div>\n                          </div>\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                </li>\n              </ul>\n            </div>\n            <div className=\"col-1\">\n              <div className=\"card card-body\">\n                <ul>\n                  <li>\n                    <h2>Order Summary</h2>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>Items</div>\n                      <div>${order.itemsPrice.toFixed(2)}</div>\n                    </div>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>Shipping</div>\n                      <div>${order.shippingPrice.toFixed(2)}</div>\n                    </div>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>Tax</div>\n                      <div>${order.taxPrice.toFixed(2)}</div>\n                    </div>\n                  </li>\n                  <li>\n                    <div className=\"row\">\n                      <div>\n                        <strong> Order Total</strong>\n                      </div>\n                      <div>\n                        <strong>${order.totalPrice.toFixed(2)}</strong>\n                      </div>\n                    </div>\n                  </li>\n                  <li>\n                    <button\n                      type=\"button\" onClick={paymentHandler}\n\n                      className=\"primary block\"\n\n                    >\n                      Pay Now\n                </button>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n}"]},"metadata":{},"sourceType":"module"}